var __extends=this.__extends||function(n,t){function i(){this.constructor=n}i.prototype=t.prototype,n.prototype=new i},framesPerSecond=60,Drawable=function(){function n(n){this.ctx=n}return n.prototype.draw=function(){},n}(),AnimatedDrawable=function(n){function t(t){n.call(this,t),this.ctx=t}return __extends(t,n),t.prototype.startAnimating=function(){var n=this;this.animationHandle=window.requestAnimationFrame(function(){n.startAnimating()}),this.draw()},t.prototype.stopAnimating=function(){window.cancelAnimationFrame(this.animationHandle)},t}(Drawable),Particle=function(n){function t(t){n.call(this,t),this.ctx=t}return __extends(t,n),t.prototype.update=function(){this.x+=this.horizontalMovement,this.y+=this.verticalMovement},Object.defineProperty(t.prototype,"horizontalMovement",{get:function(){return this.vx*this.dt},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"verticalMovement",{get:function(){return this.vy*this.dt},enumerable:!0,configurable:!0}),t}(Drawable),BouncingBallParticle=function(n){function t(t){n.call(this,t),this.ctx=t,this.radius=Math.random()*20+5,this.x=Math.random()*(this.ctx.canvas.width-this.radius*2)+this.radius,this.y=Math.random()*(this.ctx.canvas.height-this.radius*2)+this.radius,this.vx=(Math.random()*2-1)*40,this.vy=(Math.random()*2-1)*40,this.dt=1/framesPerSecond,this.color="hsl("+Math.floor(Math.random()*360)+",100%, 50%)"}return __extends(t,n),t.prototype.update=function(){n.prototype.update.call(this),this.shouldReverseHorizontalDirection&&(this.vx*=-1),this.shouldReverseVerticalDirection&&(this.vy*=-1)},t.prototype.draw=function(){this.ctx.beginPath(),this.ctx.arc(this.x,this.y,this.radius,0,2*Math.PI,!1),this.ctx.closePath(),this.ctx.fillStyle=this.color,this.ctx.fill()},Object.defineProperty(t.prototype,"movingToLeft",{get:function(){return this.vx<0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"movingToRight",{get:function(){return this.vx>0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"movingToTop",{get:function(){return this.vy<0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"movingToBottom",{get:function(){return this.vy>0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"overLeftBorder",{get:function(){return this.x<=this.radius},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"overRightBorder",{get:function(){return this.x>=this.ctx.canvas.width-this.radius},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"overTopBorder",{get:function(){return this.y<=this.radius},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"overBottomBorder",{get:function(){return this.y>=this.ctx.canvas.height-this.radius},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"shouldReverseHorizontalDirection",{get:function(){return this.movingToLeft&&this.overLeftBorder||this.movingToRight&&this.overRightBorder},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"shouldReverseVerticalDirection",{get:function(){return this.movingToTop&&this.overTopBorder||this.movingToBottom&&this.overBottomBorder},enumerable:!0,configurable:!0}),t}(Particle),FireworkParticle=function(n){function t(t){n.call(this,t),this.ctx=t,this.radius=Math.random()*20+5,this.x=Math.random()*(this.ctx.canvas.width-this.radius*2)+this.radius,this.y=Math.random()*(this.ctx.canvas.height-this.radius*2)+this.radius,this.vx=(Math.random()*2-1)*40,this.vy=(Math.random()*2-1)*40,this.dt=1/framesPerSecond,this.color="hsl("+Math.floor(Math.random()*360)+",100%, 50%)"}return __extends(t,n),t.prototype.update=function(){n.prototype.update.call(this),this.shouldReverseHorizontalDirection&&(this.vx*=-1),this.shouldReverseVerticalDirection&&(this.vy*=-1)},t.prototype.draw=function(){this.ctx.beginPath(),this.ctx.arc(this.x,this.y,this.radius,0,2*Math.PI,!1),this.ctx.closePath(),this.ctx.fillStyle=this.color,this.ctx.fill()},Object.defineProperty(t.prototype,"movingToLeft",{get:function(){return this.vx<0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"movingToRight",{get:function(){return this.vx>0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"movingToTop",{get:function(){return this.vy<0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"movingToBottom",{get:function(){return this.vy>0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"overLeftBorder",{get:function(){return this.x<=this.radius},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"overRightBorder",{get:function(){return this.x>=this.ctx.canvas.width-this.radius},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"overTopBorder",{get:function(){return this.y<=this.radius},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"overBottomBorder",{get:function(){return this.y>=this.ctx.canvas.height-this.radius},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"shouldReverseHorizontalDirection",{get:function(){return this.movingToLeft&&this.overLeftBorder||this.movingToRight&&this.overRightBorder},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"shouldReverseVerticalDirection",{get:function(){return this.movingToTop&&this.overTopBorder||this.movingToBottom&&this.overBottomBorder},enumerable:!0,configurable:!0}),t}(Particle),ParticleType=function(){function n(){}return n.BouncingBall="BouncingBall",n}(),ParticleFactory=function(){function n(n){this.ctx=n}return n.prototype.create=function(n){if(n==ParticleType.BouncingBall)return new BouncingBallParticle(this.ctx);throw"Invalid particle type specified";},n}(),Particles=function(n){function t(t,i){typeof i=="undefined"&&(i=ParticleType.BouncingBall),n.call(this,t),this.ctx=t,this.particleType=i,this.numberOfParticlesToRender=10,this.particleFactory=new ParticleFactory(t),this.createParticles()}return __extends(t,n),t.prototype.createParticles=function(){this.particles=[];for(var n=0;n<this.numberOfParticlesToRender;++n)this.particles.push(this.particleFactory.create(this.particleType))},t.prototype.refresh=function(){this.createParticles()},t.prototype.draw=function(){this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height);for(var n=0;n<this.particles.length;n++)this.particles[n].update(),this.particles[n].draw()},t}(AnimatedDrawable),ViewModel=function(){function n(){this.animating=ko.observable(!1);var n=$("#particlesCanvas")[0],t=n.getContext("2d");this.particles=new Particles(t),this.startAnimating()}return n.prototype.startAnimating=function(){this.animating(!0),this.particles.startAnimating()},n.prototype.stopAnimating=function(){this.particles.stopAnimating(),this.animating(!1)},n.prototype.refresh=function(){this.particles.refresh()},n}();$(document).ready(function(){var n=new ViewModel;ko.applyBindings(n)})